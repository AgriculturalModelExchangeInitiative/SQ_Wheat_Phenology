<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE Model PUBLIC " " "https://raw.githubusercontent.com/AgriculturalModelExchangeInitiative/crop2ml/master/ModelUnit.dtd">
<Model id="SQ.WheatPhenology.UpdateLeafFlag" name="UpdateLeafFlag" timestep="1" version="1.0">
    <Description>
        <Title>UpdateLeafFlag Model</Title>
        <Authors>Pierre MARTRE</Authors>
        <Institution>INRA Montpellier</Institution>
        <Reference>Modeling development phase in the 
                Wheat Simulation Model SiriusQuality.
                See documentation at http://www1.clermont.inra.fr/siriusquality/?page_id=427</Reference>
        <Abstract><![CDATA[tells if flag leaf has appeared and update the calendar if so]]>
    	</Abstract>
    </Description>
    <Inputs>
        <Input name="cumulTT" description="cumul thermal times at current date" variablecategory="auxiliary" datatype="DOUBLE" min="-200" max="10000" default="741.510096671757" unit="°C d" uri="some url" inputtype="variable"/>
        <Input name="LeafNumber" description="Actual number of phytomers"  variablecategory="state" datatype="DOUBLE" min="0" max="25" default="8.919453833361189" unit="leaf" uri="some url" inputtype = "variable"/>
        <Input name="calendarMoments" description="List containing apparition of each stage" variablecategory="auxiliary"  datatype="STRINGLIST"  default= "['ZC_00_Sowing']" unit=""  inputtype = "variable"/>
        <Input name="calendarDates" description="List containing  the dates of the wheat developmental phases" variablecategory="auxiliary" datatype="DATELIST" default="[21/3/2007]" unit=""  inputtype = "variable"/>
        <Input name="calendarCumuls" description="list containing for each stage occured its cumulated thermal times" variablecategory="auxiliary"  datatype="DOUBLELIST" default="[0.0]" unit="°C d"  inputtype = "variable"/>
        <Input name="currentdate" description=" current date" variablecategory="auxiliary"  datatype="DATE" default="29/4/2007" unit="" uri="some url" inputtype = "variable"/>
        <Input name="FinalLeafNumber" description="final leaf number" variablecategory="state" datatype="DOUBLE" min="0" max="10000" default="8.797582013199484" unit="leaf" uri="some url" inputtype = "variable"/>
        <Input name="HasFlagLeafLiguleAppeared" description="true if flag leaf has appeared (leafnumber reached finalLeafNumber)" variablecategory="state"  datatype="INT" min="0" max="1" unit="" uri="some url" inputtype="variable"/>
        <Input name="phase" description=" the name of the phase" variablecategory="state"  datatype="DOUBLE" min="0" max="7" default = "1" unit="" uri="some url" inputtype="variable"/>
     
    </Inputs>
    <Outputs>
        <Output name="HasFlagLeafLiguleAppeared" description="true if flag leaf has appeared (leafnumber reached finalLeafNumber)" variablecategory="state"  datatype="INT" min="0" max="1" unit="" uri="some url"/>
        <Output name="calendarMoments" description=" List containing apparition of each stage" variablecategory="auxiliary" datatype="STRINGLIST "  unit="" />
        <Output name="calendarDates" description=" List containing  the dates of the wheat developmental phases" variablecategory="auxiliary"  datatype="DATELIST "  unit=""/>
        <Output name="calendarCumuls" description=" list containing for each stage occured its cumulated thermal times" variablecategory="auxiliary"  datatype="DOUBLELIST "  unit="°C d" />
   	
    </Outputs>
    
    <Algorithm  language="C#" platform="" filename="updateLeafFlag.cs" />
	<Algorithm  language="python" platform="" filename="updateLeafFlag.py" />
    <Algorithm  language="Java" platform="" filename="updateLeafFlag.java"  />
	<Algorithm  language="Cython" platform="" filename="updateLeafFlag.pyx"  />
    <Algorithm  language="R" platform="" filename="updateLeafFlag.r"  />
	<Algorithm  language="C++" platform="" filename="updateLeafFlag.cpp"  />
    
     <Parametersets>
        <Parameterset name="wheat" description="some values in there" >
        </Parameterset>

     </Parametersets>
     <Testsets>
        <Testset name="check wheat model1" parameterset = "wheat" description="some values in there" >
        	<Test name ="test_wheat1">
        		<InputValue name="HasFlagLeafLiguleAppeared">0</InputValue>
        		<InputValue name="phase">3</InputValue>
				<InputValue name="calendarMoments">['Sowing', 'Emergence', 'FloralInitiation']</InputValue>
				<InputValue name="calendarDates">['21/3/2007', '27/3/2007', '9/4/2007']</InputValue>
				<InputValue name="calendarCumuls">[0.0, 112.330110409888, 354.582294511779]</InputValue>
				<OutputValue name="HasFlagLeafLiguleAppeared" precision ="2">1</OutputValue>
				<OutputValue name="calendarMoments">['Sowing', 'Emergence', 'FloralInitiation', 'FlagLeafLiguleJustVisible']</OutputValue>
				<OutputValue name="calendarDates">['21/3/2007', '27/3/2007', '9/4/2007', '29/4/2007']</OutputValue>
				<OutputValue name="calendarCumuls">[0.0, 112.330110409888, 354.582294511779, 741.510096671757]</OutputValue>
        	
        	</Test>

        </Testset>
    
      </Testsets>
 	
</Model>
